<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Website with DevTools</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .section { padding: 20px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; }
        button { padding: 10px 15px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; background: #007bff; color: white; }
        input { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; }
        .live-indicator { 
            position: fixed; 
            top: 10px; 
            right: 10px; 
            background: #28a745; 
            color: white; 
            padding: 5px 10px; 
            border-radius: 15px; 
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="live-indicator">🟢 DevTools LIVE</div>
    <div class="container">
        <div id="root"></div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useContext, createContext, useCallback } = React;

        // React Fusion State Implementation
        const FusionStateContext = createContext(null);

        const useFusionState = (key, initialValue) => {
            const context = useContext(FusionStateContext);
            if (!context) {
                throw new Error('useFusionState must be used within a FusionStateProvider');
            }
            
            const { state, setState } = context;
            const value = state[key] !== undefined ? state[key] : initialValue;
            
            const setValue = useCallback((newValue) => {
                setState(prevState => ({
                    ...prevState,
                    [key]: typeof newValue === 'function' ? newValue(prevState[key]) : newValue
                }));
            }, [key, setState]);
            
            return [value, setValue];
        };

        const useFusionStateLog = () => {
            const context = useContext(FusionStateContext);
            return context ? context.state : {};
        };

        const FusionStateProvider = ({ children }) => {
            const [state, setState] = useState({});
            
            const value = { state, setState };
            return React.createElement(FusionStateContext.Provider, { value }, children);
        };

        // DevTools Panel - LIVE Updates
        const FusionDebugPanel = ({ visible, onVisibilityChange }) => {
            const globalSnapshot = useFusionStateLog();
            const { setState } = useContext(FusionStateContext);
            const [expandedKeys, setExpandedKeys] = useState({});
            
            // Keyboard shortcut
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.key === '`') {
                        e.preventDefault();
                        onVisibilityChange?.(!visible);
                    }
                };
                
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [visible, onVisibilityChange]);
            
            if (!visible) return null;

            const toggleExpanded = (key) => {
                setExpandedKeys(prev => ({ ...prev, [key]: !prev[key] }));
            };

            const resetValue = (key) => {
                setState(prev => ({ ...prev, [key]: null }));
            };
            
            return React.createElement('div', {
                style: {
                    position: 'fixed',
                    bottom: '20px',
                    right: '20px',
                    width: '350px',
                    maxHeight: '500px',
                    backgroundColor: '#1a1a1a',
                    color: 'white',
                    border: '1px solid #333',
                    borderRadius: '8px',
                    fontFamily: 'monospace',
                    fontSize: '12px',
                    zIndex: 9999,
                    overflow: 'hidden',
                    boxShadow: '0 8px 32px rgba(0, 0, 0, 0.3)'
                }
            }, [
                // Header
                React.createElement('div', {
                    key: 'header',
                    style: {
                        backgroundColor: '#2d2d2d',
                        padding: '12px',
                        borderBottom: '1px solid #333',
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center'
                    }
                }, [
                    React.createElement('strong', { key: 'title' }, '🛠️ Fusion State LIVE'),
                    React.createElement('button', {
                        key: 'close',
                        onClick: () => onVisibilityChange?.(false),
                        style: { 
                            background: '#666', 
                            color: 'white', 
                            border: 'none', 
                            borderRadius: '3px', 
                            cursor: 'pointer', 
                            padding: '4px 8px' 
                        }
                    }, '×')
                ]),
                
                // Content - LIVE DATA
                React.createElement('div', {
                    key: 'content',
                    style: { padding: '12px', maxHeight: '400px', overflowY: 'auto' }
                }, Object.keys(globalSnapshot).length === 0 ? 
                    React.createElement('div', {
                        style: { color: '#888', textAlign: 'center', padding: '20px' }
                    }, 'No state yet - interact with your app!') :
                    [
                        React.createElement('div', {
                            key: 'live-indicator',
                            style: { 
                                background: '#28a745', 
                                color: 'white', 
                                padding: '4px 8px', 
                                borderRadius: '12px', 
                                fontSize: '10px',
                                textAlign: 'center',
                                marginBottom: '10px'
                            }
                        }, `🟢 LIVE - ${Object.keys(globalSnapshot).length} state keys`),
                        
                        ...Object.keys(globalSnapshot).sort().map(key => 
                            React.createElement('div', {
                                key,
                                style: { 
                                    marginBottom: '8px', 
                                    border: '1px solid #333', 
                                    borderRadius: '4px',
                                    backgroundColor: '#222'
                                }
                            }, [
                                // State header - LIVE VALUE
                                React.createElement('div', {
                                    key: 'header',
                                    onClick: () => toggleExpanded(key),
                                    style: {
                                        padding: '6px 10px',
                                        backgroundColor: '#2a2a2a',
                                        cursor: 'pointer',
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center'
                                    }
                                }, [
                                    React.createElement('span', {
                                        key: 'key',
                                        style: { fontWeight: 'bold', color: '#4fc3f7' }
                                    }, `${expandedKeys[key] ? '▼' : '▶'} ${key}`),
                                    React.createElement('span', {
                                        key: 'value',
                                        style: { 
                                            color: '#ffa726',
                                            fontSize: '10px',
                                            maxWidth: '150px',
                                            overflow: 'hidden',
                                            textOverflow: 'ellipsis',
                                            whiteSpace: 'nowrap'
                                        }
                                    }, JSON.stringify(globalSnapshot[key]))
                                ]),
                                
                                // Expanded content
                                expandedKeys[key] && React.createElement('div', {
                                    key: 'content',
                                    style: { padding: '10px' }
                                }, [
                                    React.createElement('pre', {
                                        key: 'json',
                                        style: {
                                            background: '#1a1a1a',
                                            padding: '8px',
                                            borderRadius: '4px',
                                            margin: '0 0 8px 0',
                                            fontSize: '10px',
                                            whiteSpace: 'pre-wrap',
                                            maxHeight: '100px',
                                            overflow: 'auto',
                                            border: '1px solid #333'
                                        }
                                    }, JSON.stringify(globalSnapshot[key], null, 2)),
                                    React.createElement('button', {
                                        key: 'reset',
                                        onClick: () => resetValue(key),
                                        style: {
                                            padding: '4px 8px',
                                            fontSize: '10px',
                                            backgroundColor: '#f44336',
                                            border: 'none',
                                            color: 'white',
                                            borderRadius: '3px',
                                            cursor: 'pointer'
                                        }
                                    }, 'Reset to null')
                                ])
                            ])
                        )
                    ]
                )
            ]);
        };

        // YOUR WEBSITE COMPONENTS - Replace your useState with useFusionState
        const YourApp = () => {
            // LIVE STATE - These will appear in DevTools instantly!
            const [counter, setCounter] = useFusionState('counter', 0);
            const [user, setUser] = useFusionState('user', { name: 'John', email: 'john@example.com' });
            const [todos, setTodos] = useFusionState('todos', []);
            const [settings, setSettings] = useFusionState('settings', { theme: 'light', notifications: true });
            
            const addTodo = () => {
                const newTodo = { id: Date.now(), text: `Task ${Date.now()}`, done: false };
                setTodos(prev => [...prev, newTodo]);
            };

            const toggleTodo = (id) => {
                setTodos(prev => prev.map(todo => 
                    todo.id === id ? { ...todo, done: !todo.done } : todo
                ));
            };

            return (
                <div>
                    <h1>🚀 Your Website with LIVE DevTools</h1>
                    <p><strong>Press Ctrl+` (or Cmd+` on macOS) to see LIVE state changes!</strong></p>
                    
                    {/* Counter Section */}
                    <div className="section">
                        <h2>📊 Counter: {counter}</h2>
                        <button onClick={() => setCounter(counter + 1)}>+1</button>
                        <button onClick={() => setCounter(counter + 10)}>+10</button>
                        <button onClick={() => setCounter(0)}>Reset</button>
                    </div>

                    {/* User Section */}
                    <div className="section">
                        <h2>👤 User Profile</h2>
                        <div>
                            <input 
                                placeholder="Name"
                                value={user.name} 
                                onChange={(e) => setUser({...user, name: e.target.value})} 
                            />
                            <input 
                                placeholder="Email"
                                value={user.email} 
                                onChange={(e) => setUser({...user, email: e.target.value})} 
                            />
                        </div>
                        <p>Current: {user.name} ({user.email})</p>
                    </div>

                    {/* Todos Section */}
                    <div className="section">
                        <h2>📝 Todos ({todos.length})</h2>
                        <button onClick={addTodo}>Add Todo</button>
                        {todos.map(todo => (
                            <div key={todo.id} style={{margin: '5px 0'}}>
                                <label>
                                    <input 
                                        type="checkbox" 
                                        checked={todo.done}
                                        onChange={() => toggleTodo(todo.id)}
                                    />
                                    {todo.text} {todo.done ? '✅' : '⏳'}
                                </label>
                            </div>
                        ))}
                    </div>

                    {/* Settings Section */}
                    <div className="section">
                        <h2>⚙️ Settings</h2>
                        <label>
                            <input 
                                type="checkbox" 
                                checked={settings.theme === 'dark'}
                                onChange={(e) => setSettings({...settings, theme: e.target.checked ? 'dark' : 'light'})}
                            />
                            Dark Theme ({settings.theme})
                        </label>
                        <br/>
                        <label>
                            <input 
                                type="checkbox" 
                                checked={settings.notifications}
                                onChange={(e) => setSettings({...settings, notifications: e.target.checked})}
                            />
                            Notifications ({settings.notifications ? 'ON' : 'OFF'})
                        </label>
                    </div>
                </div>
            );
        };

        // Main App with DevTools
        const App = () => {
            const [debugVisible, setDebugVisible] = useState(true); // Start visible for demo
            
            return (
                <FusionStateProvider>
                    <YourApp />
                    <FusionDebugPanel 
                        visible={debugVisible}
                        onVisibilityChange={setDebugVisible}
                    />
                </FusionStateProvider>
            );
        };

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
        
        console.log('🟢 LIVE DevTools ready!');
        console.log('🎯 Press Ctrl+` to toggle panel');
        console.log('🔄 All state changes are LIVE!');
    </script>
</body>
</html>
